<?php
	/******************************************************************
	
	******************************************************************/

	$folder=$this->call("system.get.folder.phtml");
	$oldlocation=$this->path;
	$this->call("system.rename.phtml", $arCallArgs);
	if (!$this->error) {
		// FIXME: add new path to tree
		?>
			<script>
				if (top.window && top.window.opener && top.window.opener.top.tree) {
					target=top.window.opener.top.tree;
				} else if (window.opener && window.opener.top.tree) {
					target=window.opener.top.tree;
				}
				target.DelLinks('<?php echo $oldlocation; ?>');
				target.AddLinks('<?php echo $this->parent; ?>', 
					'<?php echo $folder["icon"]; ?>', '<?php echo $folder["name"]; ?>', 
					'<?php echo $this->path; ?>', '<?php echo $folder["pre"]; ?>');
				window.opener.top.View('<?php echo $this->path; ?>');
				window.close();
			</script>
		<?php
	} else {
		echo "<font color='red'>$this->error</font>";
	}
?>