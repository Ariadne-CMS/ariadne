<?php
	if (!$arLoginMessage) {
		$arLoginMessage=$ARnls["loginrequired"];
	}
	global $nocache;
	$nocache=true;
	// make sure no language select dialog is shown.
	$ARCurrent->nolangcheck=true;
	if (!$arReturnPath) {
		$split=strrpos($_SERVER['PATH_INFO'], "/");
		$function=substr($_SERVER['PATH_INFO'],$split+1);
		$arReturnPath=$this->path;
	}
	if (!$arReturnTemplate) {
		$arReturnTemplate=$function;
		if (ldGetServerVar("QUERY_STRING")) {
			$arReturnTemplate.="?".ldGetServerVar("QUERY_STRING");
		}
	}
	$arCallArgs['arReturnPath'] = $arReturnPath;
	$arCallArgs['arReturnTemplate'] = $arReturnTemplate;
	if ($this->CheckConfig($arCallFunction, $arCallArgs)) {
		if (!$arPopup) {
			$this->call("user.login.form.html", $arCallArgs);
		} else {
			$this->call("user.login.popup.html", $arCallArgs);
		}
	}
?>