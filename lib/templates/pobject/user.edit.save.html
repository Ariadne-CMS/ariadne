<?php
	if ($this->CheckLogin('edit') && $this->CheckConfig($arCallFunction, $arCallArgs)) {
?>
<html>
<head>
<title>Saving Data</title>
<script>
  function addFormElement(name, value) {
    eValue=new String(value);
    eValue=eValue.replace(/"/g,'&quot;');
  	document.forms[0].insertAdjacentHTML('BeforeEnd','<input type="hidden" name="'+name+'" value="'+eValue+'">');
  }

  function dosave() {
	while (top.window.opener.isDirty()) {
		if (field = top.window.opener.getDirtyField()) {
			addFormElement('changes['+field.path+']'+field.name, field.value);
		}
	}
    document.forms[0].submit();
  }
</script>
</head>
<style>
  body {
    height: 100%;
    width: 100%;
    margin: 0px;
    border: 0px;
    padding: 0px;
    font: menu;
    background-color: buttonface;
  }
</style>
<body onLoad="dosave();">
<p>Saving Data...</p>
<form method='POST' action='user.edit.save.all.phtml'>
<input type="hidden" name="arReturnPage" value="<?php echo $arReturnPage; ?>">
</form>
</body>
</html>
<?php
	}
?>