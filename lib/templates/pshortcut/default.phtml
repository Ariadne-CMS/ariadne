<?php
	$path=$this->store->make_path($this->parent, $data->path);
	$MAXLOOPCOUNT=10;
	if ($ARBeenhere[$arCallFunction][$path]<$MAXLOOPCOUNT) {
		$ARBeenHere[$arCallFunction][$path]+=1;

		if ($this->data->path) {
			if (!$ARConfig->cache[$this->data->path]) {
				$this->get($this->data->path, "system.get.config.phtml");
			}
			$configcache = $ARConfig->cache[$this->data->path];
			$configcache->templates_path = $this->path;
			$ARConfig->cache[$this->data->path] = $configcache;
		}
		if ($this->CheckConfig($arCallFunction, $arCallArgs)) {
			if ($path && $this->store->exists($path)) {
				$arCallArgs=array_merge($arCallArgs, Array("arShortCut" => $this->path));

				if (!is_array($ARCurrent->shortcut_redirect)) {
					$ARCurrent->shortcut_redirect = Array();
				}
				array_push($ARCurrent->shortcut_redirect, Array($this->path => $path));
					$arResult=current($this->get($path, $arCallFunction, $arCallArgs));
				array_pop($ARCurrent->shortcut_redirect);
			} else {
				$arResult=false;
				$this->error=sprintf($ARnls["err:shortcutnopath"],$this->path,$path);
			}
		}
		unset($ARConfig->cache[$this->data->path]->templates_path);
	} else {
		error( sprintf($ARnls["err:shortcutloopexceed"],$data->path, $arCallFunction,$MAXLOOPCOUNT,$this->path) );
	}
?>