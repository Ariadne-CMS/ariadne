<?php
	if (!$wgHTMLEditOptionsPath) {
		if ($this->arIsNewObject) {
			$wgHTMLEditOptionsPath=$this->parent;
		} else {
			$wgHTMLEditOptionsPath=$this->path;
		}
	}
	if (!$wgHTMLEditOptions) {
		$wgHTMLEditOptions=current($this->get($wgHTMLEditOptionsPath, "editor.ini"));
	}
?><script language="javascript">
<!--
<?php
	function make_ini_options($name, $option) {
		if (is_array($option)) {
			reset($option);
			echo "	$name = new Array();\n";
			while (list($key, $value)=each($option)) {
				make_ini_options($name."[\"$key\"]", $value);
			}
		} else
		if (is_string($option)) {
			echo "	$name = \"".AddCSlashes($option, ARESCAPE)."\";\n";
		} else {
			echo "	$name = ".(int)$option.";\n";
		}
	}

	if (is_array($wgHTMLEditOptions)) {
		echo "var ";
		make_ini_options("wgHTMLEditOptions", $wgHTMLEditOptions);
	}
    $options.="options[editor.ini]=".RawUrlEncode($wgHTMLEditOptionsPath);
?>
wgHTMLEditOptions["editor.ini"]="<?php echo $wgHTMLEditOptionsPath; ?>";

function HTMLEdit(root, path, file, name, language, type, title, value, save2form) {
	if (value) {
		window.wgHTMLEditContent=value;
	}
	editwindow=window.open('','editwindow', 'directories=no,height=450,width=640,location=no,menubar=no,status=yes,toolbar=no,resizable=yes');
	top.editwindow=editwindow;
	editwindow.opener=window;
	if (editwindow.exists) {
		editwindow.loadpage(root, path, file, name, language, type, value, save2form, '', wgHTMLEditOptions); 
	} else {
		editwindow.location.href='edit.object.html.phtml?'+
		'root='+escape(root)+'&path='+escape(path)+'&file='+escape(file)+
		'&name='+escape(name)+'&language='+escape(language)+'&type='+escape(type)+
		'&title='+escape(title)+'&value='+escape(value)+'&save2form='+escape(save2form); //+'&<?php echo $options; ?>';
	}
	editwindow.focus();
}


// -->
</script>